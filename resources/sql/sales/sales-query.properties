countInbound=select sum(w_amount) as sum from warehousing where extract(year from w_date)=? and extract(month from w_date)=? and w_reason = 'S'
countOutbound=select sum(r_amount) as sum from be_released where extract(year from r_date)=? and extract(month from r_date)=? and r_reason = '매장출고'
rankingShop=select rownum, D.s_code, shop.s_name, totalsum, shop.s_tel from (select sum(sum) as totalsum, s_code from (select ordr.p_code, s_code, ordr.o_amount*product.p_price as sum from ordr left join product on product.p_code=ordr.p_code where extract(year from o_date)=?) group by s_code order by totalsum desc) D left join shop on shop.s_code=D.s_code where rownum between 1 and 6
mostSoldProducts=select rownum, quantity, p_name from (select sum(r_amount) quantity, p_name from be_released left join product on product.p_code=be_released.p_code where r_reason='매장출고' and (extract(year from r_date)=?) group by p_name order by quantity) where rownum between 1 and 10
rankingTransfer=select rownum, T.p_code, product.p_name, tsum from(select sum(t_amount) tsum, p_code from (select transfer.P_CODE, t_amount from transfer where departure_code=? and extract(year from t_date)=?) group by p_code order by sum(t_amount) desc) T left join product on T.p_code=product.p_code where rownum between 1 and 10 order by tsum desc
countCategory=select p_category, sum(s_amount) from stock left join product on product.p_code=stock.p_code group by p_category
countTheme=select p_theme, sum(s_amount) from stock left join product on product.p_code=stock.p_code group by p_theme
countAnnualInbound=select sum(w_amount) as sum, extract(year from w_date) year from warehousing where extract(year from w_date) in (?,?,?,?) and w_reason = 'S' and c_code=? group by extract(year from w_date) order by year asc
countAnnualOutbound=select sum(r_amount) as sum, extract(year from r_date) year from be_released left join ordr on be_released.o_code = ordr.o_code where extract(year from r_date) in (?,?,?,?) and r_reason = '매장출고' and c_code=? group by extract(year from r_date) order by year asc
annualRevenue=select sum(revenue), year from(select p_price*r_amount as revenue, extract(year from r_date) as year, B.o_code, O.c_code from (be_released B left join product P on B.p_code=P.p_code) left join ordr O on B.o_code=O.o_Code where r_reason='매장출고' and O.c_code=?) where year in (?, ?, ?, ?) group by year order by year asc
monthlyRevenue=select sum(rev), extract(month from r_date) month from (select product.p_price*be_released.r_amount rev, be_released.r_date from be_released left join product on be_released.p_code=product.p_code where r_reason='매장출고' and extract(year from r_date)=?) group by extract(month from r_date) order by month asc
dailyRevenue=select to_char(r_date, 'yyyymmdd') getdate, sum(rev) from(select product.p_price*be_released.r_amount rev, be_released.r_date, ordr.c_code from be_released join product on be_released.p_code=product.p_code join ordr on ordr.o_code=be_released.o_code where r_reason='매장출고' and c_code=? and r_date between sysdate-6 and sysdate) group by to_char(r_date, 'yyyymmdd') order by to_char(r_date, 'yyyymmdd') asc
todayRevenue=select sum(rev), to_char(r_date, 'yyyymmdd') r_date from(select product.p_price*be_released.r_amount rev, be_released.r_date from be_released join product on be_released.p_code=product.p_code join ordr on ordr.o_code=be_released.o_code where r_reason='매장출고' and to_char(r_date, 'yyyymmdd')=to_char(sysdate, 'yyyymmdd')) group by to_char(r_date, 'yyyymmdd')